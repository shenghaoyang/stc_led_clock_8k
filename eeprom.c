/*
 * eeprom.c
 *
 *  Created on: 25 Jul 2017
 *      Author: shenghao
 */
#define EEPROM_C_
#include <eeprom.h>
#undef EEPROM_C_

__code __at(0x2000) uint16_t EEPROM_PWM_FROM_LDR_TABLE[1024] = {
		59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59904,59838,59772,59706,59640,59574,59508,59442,59376,59310,59244,59178,59112,59046,58980,58914,58848,58782,58716,58651,58585,58519,58453,58387,58321,58255,58189,58123,58057,57991,57925,57859,57793,57727,57661,57595,57529,57463,57397,57331,57265,57199,57133,57067,57001,56935,56869,56803,56737,56671,56605,56539,56473,56407,56341,56275,56209,56144,56078,56012,55946,55880,55814,55748,55682,55616,55550,55484,55418,55352,55286,55220,55154,55088,55022,54956,54890,54824,54758,54692,54626,54560,54494,54428,54362,54296,54230,54164,54098,54032,53966,53900,53834,53768,53702,53637,53571,53505,53439,53373,53307,53241,53175,53109,53043,52977,52911,52845,52779,52713,52647,52581,52515,52449,52383,52317,52251,52185,52119,52053,51987,51921,51855,51789,51723,51657,51591,51525,51459,51393,51327,51261,51196,51130,51064,50998,50932,50866,50800,50734,50668,50602,50536,50470,50404,50338,50272,50206,50140,50074,50008,49942,49876,49810,49744,49678,49612,49546,49480,49414,49348,49282,49216,49150,49084,49018,48952,48886,48820,48754,48689,48623,48557,48491,48425,48359,48293,48227,48161,48095,48029,47963,47897,47831,47765,47699,47633,47567,47501,47435,47369,47303,47237,47171,47105,47039,46973,46907,46841,46775,46709,46643,46577,46511,46445,46379,46313,46248,46182,46116,46050,45984,45918,45852,45786,45720,45654,45588,45522,45456,45390,45324,45258,45192,45126,45060,44994,44928,44862,44796,44730,44664,44598,44532,44466,44400,44334,44268,44202,44136,44070,44004,43938,43872,43806,43741,43675,43609,43543,43477,43411,43345,43279,43213,43147,43081,43015,42949,42883,42817,42751,42685,42619,42553,42487,42421,42355,42289,42223,42157,42091,42025,41959,41893,41827,41761,41695,41629,41563,41497,41431,41365,41299,41234,41168,41102,41036,40970,40904,40838,40772,40706,40640,40574,40508,40442,40376,40310,40244,40178,40112,40046,39980,39914,39848,39782,39716,39650,39584,39518,39452,39386,39320,39254,39188,39122,39056,38990,38924,38858,38793,38727,38661,38595,38529,38463,38397,38331,38265,38199,38133,38067,38001,37935,37869,37803,37737,37671,37605,37539,37473,37407,37341,37275,37209,37143,37077,37011,36945,36879,36813,36747,36681,36615,36549,36483,36417,36351,36286,36220,36154,36088,36022,35956,35890,35824,35758,35692,35626,35560,35494,35428,35362,35296,35230,35164,35098,35032,34966,34900,34834,34768,34702,34636,34570,34504,34438,34372,34306,34240,34174,34108,34042,33976,33910,33844,33779,33713,33647,33581,33515,33449,33383,33317,33251,33185,33119,33053,32987,32921,32855,32789,32723,32657,32591,32525,32459,32393,32327,32261,32195,32129,32063,31997,31931,31865,31799,31733,31667,31601,31535,31469,31403,31338,31272,31206,31140,31074,31008,30942,30876,30810,30744,30678,30612,30546,30480,30414,30348,30282,30216,30150,30084,30018,29952,29886,29820,29754,29688,29622,29556,29490,29424,29358,29292,29226,29160,29094,29028,28962,28896,28831,28765,28699,28633,28567,28501,28435,28369,28303,28237,28171,28105,28039,27973,27907,27841,27775,27709,27643,27577,27511,27445,27379,27313,27247,27181,27115,27049,26983,26917,26851,26785,26719,26653,26587,26521,26455,26390,26324,26258,26192,26126,26060,25994,25928,25862,25796,25730,25664,25598,25532,25466,25400,25334,25268,25202,25136,25070,25004,24938,24872,24806,24740,24674,24608,24542,24476,24410,24344,24278,24212,24146,24080,24014,23948,23883,23817,23751,23685,23619,23553,23487,23421,23355,23289,23223,23157,23091,23025,22959,22893,22827,22761,22695,22629,22563,22497,22431,22365,22299,22233,22167,22101,22035,21969,21903,21837,21771,21705,21639,21573,21507,21441,21376,21310,21244,21178,21112,21046,20980,20914,20848,20782,20716,20650,20584,20518,20452,20386,20320,20254,20188,20122,20056,19990,19924,19858,19792,19726,19660,19594,19528,19462,19396,19330,19264,19198,19132,19066,19000,18935,18869,18803,18737,18671,18605,18539,18473,18407,18341,18275,18209,18143,18077,18011,17945,17879,17813,17747,17681,17615,17549,17483,17417,17351,17285,17219,17153,17087,17021,16955,16889,16823,16757,16691,16625,16559,16493,16428,16362,16296,16230,16164,16098,16032,15966,15900,15834,15768,15702,15636,15570,15504,15438,15372,15306,15240,15174,15108,15042,14976,14910,14844,14778,14712,14646,14580,14514,14448,14382,14316,14250,14184,14118,14052,13986,13921,13855,13789,13723,13657,13591,13525,13459,13393,13327,13261,13195,13129,13063,12997,12931,12865,12799,12733,12667,12601,12535,12469,12403,12337,12271,12205,12139,12073,12007,11941,11875,11809,11743,11677,11611,11545,11480,11414,11348,11282,11216,11150,11084,11018,10952,10886,10820,10754,10688,10622,10556,10490,10424,10358,10292,10226,10160,10094,10028,9962,9896,9830,9764,9698,9632,9566,9500,9434,9368,9302,9236,9170,9104,9038,8973,8907,8841,8775,8709,8643,8577,8511,8445,8379,8313,8247,8181,8115,8049,7983,7917,7851,7785,7719,7653,7587,7521,7455,7389,7323,7257,7191,7125,7059,6993,6927,6861,6795,6729,6663,6597,6532,6466,6400,6334,6268,6202,6136,6070,6004,5938,5872,5806,5740,5674,5608,5542,5476,5410,5344,5278,5212,5146,5080,5014,4948,4882,4816,4750,4684,4618,4552,4486,4420,4354,4288,4222,4156,4090,4025,3959,3893,3827,3761,3695,3629,3563,3497,3431,3365,3299,3233,3167,3101,3035,2969,2903,2837,2771,2705,2639,2573,2507,2441,2375,2309,2243,2177,2111,2045,1979,1913,1847,1781,1715,1649,1583,1518,1452,1386,1320,1254,1188,1122,1056,990,924,858,792,726,660,594,528,462,396,330,330,330,330,330,330,330,330,330,330,330,330,330,
};

__code __at(0x2000 + sizeof(EEPROM_PWM_FROM_LDR_TABLE)) uint16_t EEPROM_TEMP_FROM_THERMISTOR_TABLE[1024] = {
		0x0,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x999,
		0x995,
		0x989,
		0x984,
		0x978,
		0x972,
		0x966,
		0x961,
		0x955,
		0x950,
		0x944,
		0x939,
		0x934,
		0x929,
		0x924,
		0x919,
		0x914,
		0x909,
		0x904,
		0x899,
		0x895,
		0x890,
		0x885,
		0x881,
		0x876,
		0x872,
		0x868,
		0x863,
		0x859,
		0x855,
		0x851,
		0x847,
		0x843,
		0x838,
		0x834,
		0x831,
		0x827,
		0x823,
		0x819,
		0x815,
		0x811,
		0x808,
		0x804,
		0x800,
		0x797,
		0x793,
		0x790,
		0x786,
		0x783,
		0x779,
		0x776,
		0x772,
		0x769,
		0x766,
		0x762,
		0x759,
		0x756,
		0x753,
		0x749,
		0x746,
		0x743,
		0x740,
		0x737,
		0x734,
		0x731,
		0x728,
		0x725,
		0x722,
		0x719,
		0x716,
		0x713,
		0x710,
		0x707,
		0x705,
		0x702,
		0x699,
		0x696,
		0x693,
		0x691,
		0x688,
		0x685,
		0x683,
		0x680,
		0x677,
		0x675,
		0x672,
		0x670,
		0x667,
		0x664,
		0x662,
		0x659,
		0x657,
		0x654,
		0x652,
		0x649,
		0x647,
		0x645,
		0x642,
		0x640,
		0x637,
		0x635,
		0x633,
		0x630,
		0x628,
		0x626,
		0x623,
		0x621,
		0x619,
		0x617,
		0x614,
		0x612,
		0x610,
		0x608,
		0x606,
		0x603,
		0x601,
		0x599,
		0x597,
		0x595,
		0x593,
		0x591,
		0x588,
		0x586,
		0x584,
		0x582,
		0x580,
		0x578,
		0x576,
		0x574,
		0x572,
		0x570,
		0x568,
		0x566,
		0x564,
		0x562,
		0x560,
		0x558,
		0x556,
		0x554,
		0x552,
		0x550,
		0x549,
		0x547,
		0x545,
		0x543,
		0x541,
		0x539,
		0x537,
		0x535,
		0x534,
		0x532,
		0x530,
		0x528,
		0x526,
		0x525,
		0x523,
		0x521,
		0x519,
		0x517,
		0x516,
		0x514,
		0x512,
		0x510,
		0x509,
		0x507,
		0x505,
		0x504,
		0x502,
		0x500,
		0x498,
		0x497,
		0x495,
		0x493,
		0x492,
		0x490,
		0x488,
		0x487,
		0x485,
		0x483,
		0x482,
		0x480,
		0x479,
		0x477,
		0x475,
		0x474,
		0x472,
		0x471,
		0x469,
		0x467,
		0x466,
		0x464,
		0x463,
		0x461,
		0x460,
		0x458,
		0x457,
		0x455,
		0x454,
		0x452,
		0x450,
		0x449,
		0x447,
		0x446,
		0x444,
		0x443,
		0x441,
		0x440,
		0x439,
		0x437,
		0x436,
		0x434,
		0x433,
		0x431,
		0x430,
		0x428,
		0x427,
		0x425,
		0x424,
		0x423,
		0x421,
		0x420,
		0x418,
		0x417,
		0x415,
		0x414,
		0x413,
		0x411,
		0x410,
		0x408,
		0x407,
		0x406,
		0x404,
		0x403,
		0x402,
		0x400,
		0x399,
		0x397,
		0x396,
		0x395,
		0x393,
		0x392,
		0x391,
		0x389,
		0x388,
		0x387,
		0x385,
		0x384,
		0x383,
		0x381,
		0x380,
		0x379,
		0x377,
		0x376,
		0x375,
		0x374,
		0x372,
		0x371,
		0x370,
		0x368,
		0x367,
		0x366,
		0x365,
		0x363,
		0x362,
		0x361,
		0x360,
		0x358,
		0x357,
		0x356,
		0x354,
		0x353,
		0x352,
		0x351,
		0x350,
		0x348,
		0x347,
		0x346,
		0x345,
		0x343,
		0x342,
		0x341,
		0x340,
		0x338,
		0x337,
		0x336,
		0x335,
		0x334,
		0x332,
		0x331,
		0x330,
		0x329,
		0x328,
		0x326,
		0x325,
		0x324,
		0x323,
		0x322,
		0x320,
		0x319,
		0x318,
		0x317,
		0x316,
		0x315,
		0x313,
		0x312,
		0x311,
		0x310,
		0x309,
		0x308,
		0x306,
		0x305,
		0x304,
		0x303,
		0x302,
		0x301,
		0x300,
		0x298,
		0x297,
		0x296,
		0x295,
		0x294,
		0x293,
		0x292,
		0x291,
		0x289,
		0x288,
		0x287,
		0x286,
		0x285,
		0x284,
		0x283,
		0x282,
		0x280,
		0x279,
		0x278,
		0x277,
		0x276,
		0x275,
		0x274,
		0x273,
		0x272,
		0x271,
		0x269,
		0x268,
		0x267,
		0x266,
		0x265,
		0x264,
		0x263,
		0x262,
		0x261,
		0x260,
		0x259,
		0x258,
		0x256,
		0x255,
		0x254,
		0x253,
		0x252,
		0x251,
		0x250,
		0x249,
		0x248,
		0x247,
		0x246,
		0x245,
		0x244,
		0x243,
		0x242,
		0x240,
		0x239,
		0x238,
		0x237,
		0x236,
		0x235,
		0x234,
		0x233,
		0x232,
		0x231,
		0x230,
		0x229,
		0x228,
		0x227,
		0x226,
		0x225,
		0x224,
		0x223,
		0x222,
		0x221,
		0x220,
		0x219,
		0x218,
		0x217,
		0x216,
		0x215,
		0x214,
		0x212,
		0x211,
		0x210,
		0x209,
		0x208,
		0x207,
		0x206,
		0x205,
		0x204,
		0x203,
		0x202,
		0x201,
		0x200,
		0x199,
		0x198,
		0x197,
		0x196,
		0x195,
		0x194,
		0x193,
		0x192,
		0x191,
		0x190,
		0x189,
		0x188,
		0x187,
		0x186,
		0x185,
		0x184,
		0x183,
		0x182,
		0x181,
		0x180,
		0x179,
		0x178,
		0x177,
		0x176,
		0x175,
		0x174,
		0x173,
		0x172,
		0x171,
		0x170,
		0x169,
		0x168,
		0x167,
		0x166,
		0x165,
		0x164,
		0x163,
		0x163,
		0x162,
		0x161,
		0x160,
		0x159,
		0x158,
		0x157,
		0x156,
		0x155,
		0x154,
		0x153,
		0x152,
		0x151,
		0x150,
		0x149,
		0x148,
		0x147,
		0x146,
		0x145,
		0x144,
		0x143,
		0x142,
		0x141,
		0x140,
		0x139,
		0x138,
		0x137,
		0x136,
		0x135,
		0x134,
		0x133,
		0x132,
		0x131,
		0x130,
		0x129,
		0x128,
		0x128,
		0x127,
		0x126,
		0x125,
		0x124,
		0x123,
		0x122,
		0x121,
		0x120,
		0x119,
		0x118,
		0x117,
		0x116,
		0x115,
		0x114,
		0x113,
		0x112,
		0x111,
		0x110,
		0x109,
		0x108,
		0x107,
		0x106,
		0x105,
		0x104,
		0x103,
		0x103,
		0x102,
		0x101,
		0x100,
		0x99,
		0x98,
		0x97,
		0x96,
		0x95,
		0x94,
		0x93,
		0x92,
		0x91,
		0x90,
		0x89,
		0x88,
		0x87,
		0x86,
		0x85,
		0x84,
		0x83,
		0x82,
		0x81,
		0x80,
		0x80,
		0x79,
		0x78,
		0x77,
		0x76,
		0x75,
		0x74,
		0x73,
		0x72,
		0x71,
		0x70,
		0x69,
		0x68,
		0x67,
		0x66,
		0x65,
		0x64,
		0x63,
		0x62,
		0x61,
		0x60,
		0x59,
		0x58,
		0x57,
		0x56,
		0x56,
		0x55,
		0x54,
		0x53,
		0x52,
		0x51,
		0x50,
		0x49,
		0x48,
		0x47,
		0x46,
		0x45,
		0x44,
		0x43,
		0x42,
		0x41,
		0x40,
		0x39,
		0x38,
		0x37,
		0x36,
		0x35,
		0x34,
		0x33,
		0x32,
		0x31,
		0x30,
		0x29,
		0x28,
		0x27,
		0x26,
		0x26,
		0x25,
		0x24,
		0x23,
		0x22,
		0x21,
		0x20,
		0x19,
		0x18,
		0x17,
		0x16,
		0x15,
		0x14,
		0x13,
		0x12,
		0x11,
		0x10,
		0x9,
		0x8,
		0x7,
		0x6,
		0x5,
		0x4,
		0x3,
		0x2,
		0x1,
		0x0,
		0x1,
		0x2,
		0x3,
		0x4,
		0x5,
		0x6,
		0x7,
		0x8,
		0x9,
		0x10,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
		0x0,
};

void eeprom_start() {
	IAP_CONTR = EEPROM_RESET_BYTE;
}

void eeprom_erase(uint8_t address){
	IAP_CMD = EEPROM_COMMAND_ERASE;
	IAP_ADDRH = (address);
	IAP_TRIG = EEPROM_TRIGGER_MAGIC0;
	IAP_TRIG = EEPROM_TRIGGER_MAGIC1;
	__asm
	nop
	__endasm;
}

void eeprom_write(uint16_t address,uint8_t data){
	IAP_CMD = EEPROM_COMMAND_WRITE;
	IAP_ADDR = address;
	IAP_DATA = data;
	IAP_TRIG = EEPROM_TRIGGER_MAGIC0;
	IAP_TRIG = EEPROM_TRIGGER_MAGIC1;
	__asm
	nop
	__endasm;
}

uint8_t eeprom_read(uint16_t address){
	IAP_CMD = EEPROM_COMMAND_READ;
	IAP_ADDR = address;
	IAP_TRIG = EEPROM_TRIGGER_MAGIC0;
	IAP_TRIG = EEPROM_TRIGGER_MAGIC1;
	__asm
	nop
	__endasm;
	return IAP_DATA;
}

void eeprom_end() {
	IAP_CONTR = EEPROM_DISABLE_BYTE;
}
